flowchart TD
    subgraph Perfiles_IA["Perfiles IA"]
        CPU["cpu\nOllama (CPU)"]
        NVIDIA["gpu-nvidia\nOllama (GPU NVIDIA)"]
        AMD["gpu-amd\nOllama (GPU AMD)"]
    end
    subgraph Servicios_Base["Servicios Base (sin perfil)"]
        QDRANT["qdrant\nDB vectorial"]
        PGVECTOR["pgvector\nDB vectores"]
        POSTGRES["postgres\nBase de datos"]
    end
    subgraph Perfiles_Servicios["Perfiles de Servicios"]
        CHATAI["chat-ai\nOpen WebUI"]
        AUTO["automation\nn8n, Watchtower, Sync"]
        MON["monitoring\nPrometheus, Grafana, AlertManager, backup"]
        SEC["security\nKeycloak, ModSecurity"]
        INFRA["infrastructure\nRedis, HAProxy"]
        CICD["ci-cd\nJenkins"]
        TEST["testing\nTest Runner"]
        DEBUG["debug\nDebug Tools"]
        DEV["dev\nHerramientas desarrollo"]
    end
    CPU -.->|"Usa"| CHATAI
    CPU -.->|"Usa"| AUTO
    NVIDIA -.->|"Usa"| CHATAI
    NVIDIA -.->|"Usa"| AUTO
    AMD -.->|"Usa"| CHATAI
    AMD -.->|"Usa"| AUTO
    CHATAI -->|"Requiere"| SEC
    AUTO -->|"Requiere"| SEC
    MON -->|"Requiere"| SEC
    CHATAI -->|"Monitorea"| MON
    AUTO -->|"Monitorea"| MON
    QDRANT -->|"Monitorea"| MON
    PGVECTOR -->|"Monitorea"| MON
    CHATAI -->|"Usa"| INFRA
    AUTO -->|"Usa"| INFRA
    AUTO -->|"Integra"| CICD
    AUTO -->|"Usa"| TEST
    AUTO -->|"Usa"| DEBUG
    AUTO -->|"Usa"| DEV
    classDef ia fill:#e0f7fa,stroke:#00796b,stroke-width:2px;
    classDef base fill:#e8f5e9,stroke:#388e3c,stroke-width:2px;
    classDef perfiles fill:#fff3e0,stroke:#e65100,stroke-width:2px;
    class Perfiles_IA ia;
    class Servicios_Base base;
    class Perfiles_Servicios perfiles; 