%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#1a1a2e', 'primaryTextColor':'#eaeaea', 'primaryBorderColor':'#4a4a6a', 'lineColor':'#6c63ff', 'fontSize':'14px', 'fontFamily':'Inter, Segoe UI, sans-serif'}}}%%
graph LR
    subgraph INPUT ["ðŸ‘¤ User Command"]
        USER["./stack-manager.sh start"]
    end
    
    subgraph PROFILES ["ðŸ“‹ Profile Selection"]
        direction TB
        P1["chat-ai"]
        P2["automation"]
        P3["monitoring"]
        P4["ci-cd"]
    end
    
    subgraph RESOLVER ["âš™ï¸ Dependency Resolver"]
        direction TB
        R["get_profile_dependencies()"]
    end
    
    subgraph RESOLVED ["âœ… Auto-Resolved Profiles"]
        direction TB
        
        subgraph R1 ["chat-ai resolves to:"]
            R1A["security"]
            R1B["infrastructure"]
            R1C["gpu-nvidia"]
        end
        
        subgraph R2 ["automation resolves to:"]
            R2A["security"]
        end
        
        subgraph R3 ["monitoring resolves to:"]
            R3A["security"]
            R3B["infrastructure"]
        end
        
        subgraph R4 ["ci-cd resolves to:"]
            R4A["security"]
        end
    end
    
    subgraph OUTPUT ["ðŸš€ Docker Compose"]
        DC["docker compose --profile ... up -d"]
    end
    
    USER --> PROFILES
    P1 --> R
    P2 --> R
    P3 --> R
    P4 --> R
    
    R --> R1
    R --> R2
    R --> R3
    R --> R4
    
    R1 --> DC
    R2 --> DC
    R3 --> DC
    R4 --> DC
    
    %% Styling
    classDef input fill:#0d47a1,stroke:#1976d2,stroke-width:2px,color:#fff
    classDef profile fill:#4a148c,stroke:#7b1fa2,stroke-width:2px,color:#fff
    classDef resolver fill:#e65100,stroke:#f57c00,stroke-width:2px,color:#fff
    classDef resolved fill:#1b5e20,stroke:#388e3c,stroke-width:2px,color:#fff
    classDef output fill:#37474f,stroke:#607d8b,stroke-width:2px,color:#fff
    
    class USER input
    class P1,P2,P3,P4 profile
    class R resolver
    class R1A,R1B,R1C,R2A,R3A,R3B,R4A resolved
    class DC output
