%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#1a1a2e', 'primaryTextColor':'#eaeaea', 'primaryBorderColor':'#4a4a6a', 'lineColor':'#6c63ff', 'fontSize':'13px', 'fontFamily':'Inter, Segoe UI, sans-serif'}}}%%
graph TB
    subgraph TITLE ["âš™ï¸ğŸ”§ AUTOMATION + CI/CD - Workflow & Pipelines"]
        direction LR
        CMD["docker compose --profile automation --profile ci-cd up -d"]
    end
    
    subgraph AUTOMATION ["âš™ï¸ automation"]
        N8N["âš™ï¸ n8n<br/>:5678<br/>â”â”â”â”â”â”â”â”â”â”<br/>â€¢ Workflow Engine<br/>â€¢ 400+ Integrations<br/>â€¢ AI Node Support"]
        WATCH["ğŸ”„ Watchtower<br/>â”â”â”â”â”â”â”â”â”â”<br/>â€¢ Auto-updates<br/>â€¢ Schedule: 2 AM<br/>â€¢ Email notifications"]
        SYNC["ğŸ“‚ Sync<br/>â”â”â”â”â”â”â”â”â”â”<br/>â€¢ Data sync<br/>â€¢ Hourly backup<br/>â€¢ rsync-based"]
    end
    
    subgraph CICD ["ğŸ”§ ci-cd"]
        JENKINS["ğŸ”§ Jenkins<br/>:8081â†’8082<br/>â”â”â”â”â”â”â”â”â”â”<br/>â€¢ Pipeline as Code<br/>â€¢ Groovy DSL<br/>â€¢ OIDC Auth"]
        PLUGINS["ğŸ“¦ Auto-Plugins<br/>â”â”â”â”â”â”â”â”â”â”<br/>â€¢ oic-auth<br/>â€¢ workflow-aggregator<br/>â€¢ git"]
    end
    
    subgraph SECURITY ["ğŸ” security (auto-included)"]
        KC["ğŸ” Keycloak<br/>:8080"]
    end
    
    subgraph AI ["ğŸ¤– AI Services"]
        OLLAMA["ğŸ§  Ollama"]
    end
    
    subgraph BASE ["ğŸ—„ï¸ Base"]
        PG["ğŸ—„ï¸ PostgreSQL"]
    end
    
    %% Connections
    N8N -->|"AI Workflows"| OLLAMA
    N8N -->|"OIDC Auth"| KC
    N8N -->|"Store Data"| PG
    
    JENKINS -->|"OIDC Auth"| KC
    PLUGINS -->|"Auto-install"| JENKINS
    
    WATCH -->|"Updates"| N8N
    WATCH -->|"Updates"| JENKINS
    
    %% Use cases
    UC["ğŸ’¡ Use Cases:<br/>â”â”â”â”â”â”â”â”â”â”<br/>â€¢ AI-powered workflows<br/>â€¢ Automated deployments<br/>â€¢ Scheduled tasks<br/>â€¢ Container management"]
    
    %% Styling
    classDef title fill:#1a1a2e,stroke:#6c63ff,stroke-width:0px,color:#fff
    classDef automation fill:#4a148c,stroke:#7b1fa2,stroke-width:2px,color:#fff
    classDef cicd fill:#37474f,stroke:#607d8b,stroke-width:2px,color:#fff
    classDef security fill:#b71c1c,stroke:#d32f2f,stroke-width:2px,color:#fff
    classDef ai fill:#0d47a1,stroke:#1976d2,stroke-width:2px,color:#fff
    classDef base fill:#455a64,stroke:#78909c,stroke-width:2px,color:#fff
    classDef note fill:#ede7f6,stroke:#7b1fa2,stroke-width:2px,color:#4a148c
    
    class CMD title
    class N8N,WATCH,SYNC automation
    class JENKINS,PLUGINS cicd
    class KC security
    class OLLAMA ai
    class PG base
    class UC note
