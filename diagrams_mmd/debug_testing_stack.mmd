%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#1a1a2e', 'primaryTextColor':'#eaeaea', 'primaryBorderColor':'#4a4a6a', 'lineColor':'#6c63ff', 'fontSize':'14px', 'fontFamily':'Inter, Segoe UI, sans-serif'}}}%%
graph TB
    subgraph TITLE ["ğŸ›ğŸ§ª DEBUG + TESTING - Development Tools"]
        direction LR
        CMD["docker compose --profile debug --profile testing up -d"]
    end
    
    subgraph TESTING ["ğŸ§ª testing"]
        TESTRUN["ğŸ§ª Test Runner<br/>â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ Service health checks<br/>â€¢ API endpoint tests<br/>â€¢ Integration tests<br/>â€¢ Report generation"]
    end
    
    subgraph DEBUG ["ğŸ› debug"]
        DBGTOOLS["ğŸ› Debug Tools<br/>â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ Docker socket access<br/>â€¢ Network inspection<br/>â€¢ Log analysis<br/>â€¢ Container shell"]
    end
    
    subgraph AVAILABLE_TESTS ["ğŸ“‹ Available Test Scripts"]
        direction LR
        T1["test-ollama-quick.sh"]
        T2["test-health-deep.sh"]
        T3["test-keycloak-claims.sh"]
        T4["test-integration.sh"]
        T5["run-all-tests.sh"]
    end
    
    subgraph TARGETS ["ğŸ¯ Test Targets"]
        OLLAMA["ğŸ§  Ollama"]
        KC["ğŸ” Keycloak"]
        PG["ğŸ—„ï¸ PostgreSQL"]
        GRAF["ğŸ“ˆ Grafana"]
        PROM["ğŸ“Š Prometheus"]
    end
    
    %% Connections
    TESTRUN -->|"Tests"| OLLAMA
    TESTRUN -->|"Tests"| KC
    TESTRUN -->|"Tests"| PG
    TESTRUN -->|"Tests"| GRAF
    TESTRUN -->|"Tests"| PROM
    
    DBGTOOLS -->|"Inspect"| OLLAMA
    DBGTOOLS -->|"Inspect"| KC
    DBGTOOLS -->|"Inspect"| PG
    
    T1 -.-> TESTRUN
    T2 -.-> TESTRUN
    T3 -.-> TESTRUN
    T4 -.-> TESTRUN
    T5 -.-> TESTRUN
    
    %% Usage note
    NOTE["ğŸ’¡ Usage:<br/>â”â”â”â”â”â”â”â”â”â”<br/>./scripts/tests/run-all-tests.sh<br/><br/>Or individual tests:<br/>./scripts/tests/test-ollama-quick.sh"]
    
    %% Styling
    classDef title fill:#1a1a2e,stroke:#6c63ff,stroke-width:0px,color:#fff
    classDef testing fill:#f57f17,stroke:#fbc02d,stroke-width:2px,color:#000
    classDef debug fill:#e65100,stroke:#f57c00,stroke-width:2px,color:#fff
    classDef tests fill:#fff8e1,stroke:#ffc107,stroke-width:2px,color:#e65100
    classDef targets fill:#37474f,stroke:#607d8b,stroke-width:2px,color:#fff
    classDef note fill:#e8f5e9,stroke:#388e3c,stroke-width:2px,color:#1b5e20
    
    class CMD title
    class TESTRUN testing
    class DBGTOOLS debug
    class T1,T2,T3,T4,T5 tests
    class OLLAMA,KC,PG,GRAF,PROM targets
    class NOTE note
