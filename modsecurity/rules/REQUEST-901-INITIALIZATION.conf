# =============================================================================
# ModSecurity Core Rule Set - Initialization Rules
# =============================================================================
# Reglas de inicialización básicas para ModSecurity
# =============================================================================

# Configuración inicial de variables
SecAction "id:901000,phase:1,nolog,pass,t:none,setvar:tx.crs_setup_version=310"

# Configuración de límites
SecAction "id:901001,phase:1,nolog,pass,t:none,setvar:tx.max_num_args=255"
SecAction "id:901002,phase:1,nolog,pass,t:none,setvar:tx.arg_name_length=100"
SecAction "id:901003,phase:1,nolog,pass,t:none,setvar:tx.arg_length=400"
SecAction "id:901004,phase:1,nolog,pass,t:none,setvar:tx.total_arg_length=64000"

# Configuración de métodos HTTP permitidos
SecAction "id:901005,phase:1,nolog,pass,t:none,setvar:'tx.allowed_methods=GET HEAD POST OPTIONS'"

# Configuración de extensiones de archivo permitidas
SecAction "id:901006,phase:1,nolog,pass,t:none,setvar:'tx.allowed_request_content_type=application/x-www-form-urlencoded|multipart/form-data|text/xml|application/xml|application/json'"

# Configuración de caracteres especiales
SecAction "id:901007,phase:1,nolog,pass,t:none,setvar:tx.max_file_size=10485760"

# Configuración de protección contra inyección SQL
SecAction "id:901008,phase:1,nolog,pass,t:none,setvar:tx.sql_injection_score=5"
SecAction "id:901009,phase:1,nolog,pass,t:none,setvar:tx.xss_score=5"

# Configuración de protección contra path traversal
SecAction "id:901010,phase:1,nolog,pass,t:none,setvar:tx.detection_paranoia_level=1"

# Configuración de rate limiting (opcional, descomentar si se necesita)
# SecAction "id:901011,phase:1,nolog,pass,t:none,setvar:tx.dos_burst_time_slice=60"
# SecAction "id:901012,phase:1,nolog,pass,t:none,setvar:tx.dos_counter_threshold=100"

